<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>xSmileyy's DPS Analytics</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=JetBrains+Mono:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root { 
            --orange: #ff6600; 
            --orange-glow: rgba(255, 102, 0, 0.4); 
            --bg: #030303; 
            --card-bg: rgba(15, 15, 15, 0.9); 
            --glass: rgba(255, 255, 255, 0.03); 
            --border: #222; 
            --text-main: #ffffff; 
            --text-dim: #888; 
            --pos: #00ff88; 
            --neg: #ff4444; 
            --crit: #ffcc00;
        }

        body { 
            font-family: 'Inter', sans-serif; 
            background: var(--bg); 
            background-image: radial-gradient(circle at 50% 0%, #1a0d00 0%, #030303 70%); 
            color: var(--text-main); 
            margin: 0; 
            padding: 30px; 
            min-height: 100vh; 
        }

        .container { max-width: 1750px; margin: auto; }

        .header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 30px; 
            border-bottom: 1px solid var(--border);
            padding-bottom: 20px;
        }

        .logo { font-size: 28px; font-weight: 800; text-transform: uppercase; letter-spacing: -0.5px; }
        .logo span { color: var(--orange); text-shadow: 0 0 15px var(--orange-glow); }

        .main-grid { display: grid; grid-template-columns: 1.1fr 0.9fr; gap: 35px; margin-bottom: 40px; }
        .card { background: var(--card-bg); border: 1px solid var(--border); border-radius: 20px; padding: 35px; backdrop-filter: blur(20px); }
        
        .section-title { 
            font-size: 13px; 
            font-weight: 800; 
            color: var(--orange); 
            text-transform: uppercase; 
            letter-spacing: 2px; 
            margin-bottom: 20px; 
            display: flex; 
            align-items: center; 
            gap: 15px; 
        }
        .section-title::after { content: ''; height: 1px; flex-grow: 1; background: var(--border); }

        .input-block { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 18px; background: var(--glass); padding: 25px; border-radius: 15px; margin-bottom: 25px; }
        .group { display: flex; flex-direction: column; }
        label { font-size: 10px; font-weight: 700; color: var(--text-dim); margin-bottom: 8px; text-transform: uppercase; }
        input, select { background: #000; border: 1px solid #333; color: #fff; padding: 12px; border-radius: 8px; font-size: 15px; font-family: 'JetBrains Mono'; transition: 0.2s; }
        input:focus { border-color: var(--orange); outline: none; box-shadow: 0 0 10px var(--orange-glow); }
        input[readonly] { color: var(--orange); cursor: pointer; border-style: dashed; }

        .toggle-btn { flex: 1; background: #111; border: 1px solid #333; color: #fff; padding: 14px; border-radius: 10px; cursor: pointer; font-size: 12px; font-weight: 700; text-transform: uppercase; transition: 0.2s; }
        .toggle-btn.active { background: var(--orange); border-color: var(--orange); box-shadow: 0 0 15px var(--orange-glow); }
        
        .range-display { background: #000; padding: 25px; border-radius: 15px; border: 1px solid #222; margin-bottom: 30px; }
        .range-result-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #111; font-size: 20px; font-family: 'JetBrains Mono'; }
        
        .results-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
        .res-box { background: #0a0a0a; border: 1px solid var(--border); padding: 20px; border-radius: 18px; }
        .res-label { font-size: 11px; color: var(--text-dim); text-transform: uppercase; display: block; margin-bottom: 8px; }
        .res-val { font-size: 22px; font-weight: 700; font-family: 'JetBrains Mono'; color: #fff; }

        .comparison-section { margin-top: 20px; border-top: 2px solid var(--orange); padding-top: 40px; }
        .btn-capture { background: #fff; color: #000; border: none; padding: 16px; border-radius: 10px; font-weight: 800; cursor: pointer; text-transform: uppercase; width: 100%; margin-top: 10px; font-size: 14px; transition: 0.3s; }
        .btn-capture:hover { background: var(--orange); color: #fff; transform: translateY(-2px); }

        .comp-table { width: 100%; border-collapse: collapse; margin-top: 25px; background: var(--card-bg); border-radius: 15px; overflow: hidden; }
        .comp-table th { background: rgba(255,255,255,0.05); text-align: left; padding: 20px; color: var(--orange); font-size: 12px; text-transform: uppercase; border-bottom: 1px solid var(--border); }
        .comp-table td { padding: 25px 20px; border-bottom: 1px solid #111; font-family: 'JetBrains Mono'; font-size: 16px; }
        .diff-tag { display: block; font-size: 12px; margin-top: 8px; font-weight: 800; padding: 4px 8px; border-radius: 5px; width: fit-content; }
        .diff-pos { background: rgba(0, 255, 136, 0.1); color: var(--pos); }
        .diff-neg { background: rgba(255, 68, 68, 0.1); color: var(--neg); }
    </style>
</head>
<body>

<div class="container">
    <header class="header">
        <div class="logo">xSmileyy's <span>DPS Analytics</span></div>
        <div style="font-size: 12px; color: var(--text-dim); font-weight: 700; text-transform: uppercase; letter-spacing: 1px;">Precision Division 2 Data Tooling</div>
    </header>

    <div class="main-grid">
        <div class="card">
            <div class="section-title">Base Damage Calculator</div>
            <div class="input-block">
                <div class="group"><label>Menu Damage</label><input type="number" id="h-game" placeholder="0"></div>
                <div class="group"><label>All Wpn Dmg %</label><input type="number" id="h-awd" placeholder="0"></div>
                <div class="group"><label>Spec. Wpn Dmg %</label><input type="number" id="h-swd" placeholder="0"></div>
                <div class="group"><label>Calculated Base</label><input type="text" id="h-res" readonly onclick="this.select()"></div>
            </div>

            <div class="section-title">Weapon Configuration</div>
            <div class="input-block">
                <div class="group"><label>Base Damage</label><input type="number" id="base" value="0"></div>
                <div class="group"><label>RPM</label><input type="number" id="rpm" value="0"></div>
                <div class="group"><label>Mag Size</label><input type="number" id="mag" value="0"></div>
                <div class="group"><label>Reload (s)</label><input type="number" id="rel" value="0"></div>
                <div class="group"><label>AWD %</label><input type="number" id="awd" value="0"></div>
                <div class="group"><label>SWD %</label><input type="number" id="swd" value="0"></div>
                <div class="group" style="grid-column: span 2;"><label>Total Talent Wpn Dmg % (TWD)</label><input type="number" id="twd" value="0"></div>
            </div>

            <div class="section-title">Combat Stats</div>
            <div class="input-block">
                <div class="group"><label>CHC %</label><input type="number" id="chc" value="0"></div>
                <div class="group"><label>CHD %</label><input type="number" id="chd" value="0"></div>
                <div class="group"><label>HSD %</label><input type="number" id="hsd" value="0"></div>
                <div class="group"><label>DttOOC %</label><input type="number" id="dttooc" value="0"></div>
                <div class="group"><label>DtA %</label><input type="number" id="dta" value="0"></div>
                <div class="group"><label>DtH %</label><input type="number" id="dth" value="0"></div>
            </div>

            <div class="section-title">Amplifiers (Multiplier)</div>
            <div class="input-block">
                <div class="group"><label>Mult 1 %</label><input type="number" id="m1" value="0"></div>
                <div class="group"><label>Mult 2 %</label><input type="number" id="m2" value="0"></div>
                <div class="group"><label>Mult 3 %</label><input type="number" id="m3" value="0"></div>
                <div class="group"><label>Mult 4 %</label><input type="number" id="m4" value="0"></div>
            </div>
            
            <div class="section-title">Capture for Comparison Matrix</div>
            <div class="input-block" style="background: rgba(255,102,0,0.05); border: 1px dashed var(--orange);">
                <div class="group" style="grid-column: span 2;"><label>Build Name</label><input type="text" id="build-name" placeholder="e.g. Ouroboros Striker"></div>
                <div class="group" style="justify-content: flex-end;"><button class="btn-capture" onclick="captureBuild()">Add to Matrix</button></div>
            </div>
        </div>

        <div class="card" style="border-top: 4px solid var(--orange);">
            <div class="section-title">Range Validator</div>
            <div style="display:flex; gap:12px; margin-bottom:25px;">
                <button class="toggle-btn active" id="btn-dta" onclick="toggleMode('dta')">Vs Armor (Elite)</button>
                <button class="toggle-btn" id="btn-dth" onclick="toggleMode('dth')">Vs Health (Dogs/Hull)</button>
            </div>
            <div class="range-display">
                <div class="range-result-row"><span>Body Hit</span><b id="val-body">-</b></div>
                <div class="range-result-row"><span>Body Crit</span><b id="val-body-crit" style="color:var(--crit)">-</b></div>
                <div class="range-result-row"><span>Headshot Hit</span><b id="val-head">-</b></div>
                <div class="range-result-row"><span>Headshot Crit</span><b id="val-head-crit" style="color:var(--neg)">-</b></div>
            </div>

            <div class="section-title">Performance Simulation</div>
            <div class="results-grid" style="margin-bottom: 30px;">
                <div class="res-box"><span class="res-label">Simulated Avg/Shot</span><span class="res-val" id="res-avg">-</span></div>
                <div class="res-box"><span class="res-label">Burst DPS</span><span class="res-val" id="res-burst">-</span></div>
                <div class="res-box"><span class="res-label">Sustain DPS</span><span class="res-val" id="res-sustain">-</span></div>
                <div class="res-box"><span class="res-label">Full Mag Damage</span><span class="res-val" id="res-mag">-</span></div>
            </div>

            <div class="section-title">Target EHP Analysis</div>
            <select id="enemy-select" style="width:100%; margin-bottom:20px; padding:15px; font-weight:700;">
                <optgroup label="HEROIC (4-PLAYER)">
                    <option value="16905653" selected>Heroic Elite (16.9M)</option>
                    <option value="47296250">Heroic Named (47.3M)</option>
                </optgroup>
                <optgroup label="LEGENDARY (4-PLAYER)">
                    <option value="25172134">Legendary Elite (25.2M)</option>
                    <option value="72146660">Legendary Named (72.1M)</option>
                </optgroup>
            </select>
            <div class="results-grid">
                <div class="res-box" style="border-color: var(--orange);"><span class="res-label">TTK (Burst)</span><span class="res-val" id="res-ttkb">-</span></div>
                <div class="res-box"><span class="res-label">Kills per Mag</span><span class="res-val" id="res-kpm">-</span></div>
            </div>
        </div>
    </div>

    <div class="comparison-section">
        <div class="card">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <div class="section-title">Comparison Matrix</div>
                <button class="toggle-btn" style="width:auto; padding:8px 20px; font-size:10px;" onclick="clearCompare()">Reset Matrix</button>
            </div>
            <div style="overflow-x: auto;">
                <table class="comp-table">
                    <thead><tr id="comp-header"><th>Metric</th></tr></thead>
                    <tbody id="comp-body"><tr><td colspan="100%" style="text-align:center; padding:50px; color:var(--text-dim);">Keine Builds erfasst. Nutze "Add to Matrix" oben.</td></tr></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    let vMode = 'dta';
    let capturedBuilds = [];
    const allInputs = document.querySelectorAll('input, select');

    function getVal(id) { return parseFloat(document.getElementById(id).value) || 0; }

    function toggleMode(m) { 
        vMode = m; 
        document.getElementById('btn-dta').classList.toggle('active', m === 'dta'); 
        document.getElementById('btn-dth').classList.toggle('active', m === 'dth'); 
        calculateAll(); 
    }

    function calculateAll() {
        const hRes = getVal('h-game') / (1 + (getVal('h-awd') + getVal('h-swd'))/100);
        document.getElementById('h-res').value = hRes > 0 ? hRes.toFixed(1) : "0";

        const base = getVal('base'), awd = getVal('awd'), swd = getVal('swd'), twd = getVal('twd');
        const chc = Math.min(60, getVal('chc'))/100, chd = getVal('chd')/100, hsd = getVal('hsd')/100;
        const dttooc = getVal('dttooc')/100, dta = getVal('dta')/100, dth = getVal('dth')/100;
        const mMult = (getVal('m1')/100+1) * (getVal('m2')/100+1) * (getVal('m3')/100+1) * (getVal('m4')/100+1);

        const armorMult = vMode === 'dta' ? (1 + dta) : (1 + dth);
        const vBody = base * (1 + (awd + swd)/100) * (1 + twd/100) * (1 + dttooc) * armorMult * mMult;
        
        document.getElementById('val-body').innerText = Math.round(vBody).toLocaleString();
        document.getElementById('val-body-crit').innerText = Math.round(vBody * (1 + chd)).toLocaleString();
        document.getElementById('val-head').innerText = Math.round(vBody * (1 + hsd)).toLocaleString();
        document.getElementById('val-head-crit').innerText = Math.round(vBody * (1 + hsd + chd)).toLocaleString();

        const avgShot = vBody * (1 + (chc * chd)) * (1 + (0.2 * hsd)); 
        const rpm = getVal('rpm'), mag = getVal('mag'), rel = getVal('rel');
        const burstDps = (rpm / 60) * avgShot;
        const sustainDps = (mag > 0 && rpm > 0) ? (mag * avgShot) / (rel + (mag / (rpm/60))) : 0;
        const targetEHP = parseFloat(document.getElementById('enemy-select').value);

        document.getElementById('res-avg').innerText = Math.round(avgShot).toLocaleString();
        document.getElementById('res-burst').innerText = Math.round(burstDps).toLocaleString();
        document.getElementById('res-sustain').innerText = Math.round(sustainDps).toLocaleString();
        document.getElementById('res-mag').innerText = Math.round(avgShot * mag).toLocaleString();
        document.getElementById('res-ttkb').innerText = burstDps > 0 ? (targetEHP/burstDps).toFixed(2) + "s" : "-";
        document.getElementById('res-kpm').innerText = (targetEHP > 0) ? ((avgShot * mag) / targetEHP).toFixed(2) : "-";

        return { avgShot, burstDps, sustainDps, magDmg: avgShot*mag, ttk: (targetEHP/burstDps) };
    }

    function captureBuild() {
        const stats = calculateAll();
        if(stats.avgShot <= 0) return;
        const name = document.getElementById('build-name').value || "Build " + (capturedBuilds.length + 1);
        capturedBuilds.push({ name, ...stats });
        document.getElementById('build-name').value = "";
        renderCompare();
    }

    function clearCompare() { if(confirm("Matrix zurÃ¼cksetzen?")) { capturedBuilds = []; renderCompare(); } }

    function renderCompare() {
        const header = document.getElementById('comp-header');
        const body = document.getElementById('comp-body');
        if(capturedBuilds.length === 0) {
            header.innerHTML = '<th>Metric</th>';
            body.innerHTML = '<tr><td colspan="100%" style="text-align:center; padding:50px;">No builds captured.</td></tr>';
            return;
        }
        header.innerHTML = '<th>Performance Metric</th>';
        capturedBuilds.forEach(b => { header.innerHTML += `<th>${b.name}</th>`; });
        const metrics = [
            { label: 'Avg Shot Damage', key: 'avgShot', h: true },
            { label: 'Burst DPS', key: 'burstDps', h: true },
            { label: 'Sustain DPS', key: 'sustainDps', h: true },
            { label: 'Full Mag Damage', key: 'magDmg', h: true },
            { label: 'TTK (Burst)', key: 'ttk', h: false }
        ];
        body.innerHTML = '';
        metrics.forEach(m => {
            let row = `<tr><td><strong>${m.label}</strong></td>`;
            capturedBuilds.forEach((b, i) => {
                const val = b[m.key];
                let diff = '';
                if(i > 0) {
                    const d = ((val - capturedBuilds[0][m.key]) / capturedBuilds[0][m.key]) * 100;
                    const isPos = m.h ? d > 0 : d < 0;
                    diff = `<span class="diff-tag ${isPos ? 'diff-pos' : 'diff-neg'}">${d > 0 ? '+' : ''}${d.toFixed(1)}%</span>`;
                }
                const disp = m.label.includes('TTK') ? val.toFixed(2)+'s' : Math.round(val).toLocaleString();
                row += `<td>${disp}${diff}</td>`;
            });
            body.innerHTML += row + '</tr>';
        });
    }

    allInputs.forEach(i => i.addEventListener('input', calculateAll));
    window.onload = calculateAll;
</script>
</body>
</html>
